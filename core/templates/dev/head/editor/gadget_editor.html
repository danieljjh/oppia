<div ng-controller="GadgetEditor">
  <span style="font-size: 16px;">
    <strong>Gadgets</strong>
  </span>
  <md-card style="background-color: white; margin: 20px 0px; padding: 10px 10px;">
    <button type="button" class="btn btn-default btn-xs oppia-add-gadget-button protractor-test-open-add-gadget-modal" ng-click="openAddGadgetModal()">
      Insert Gadget
    </button>
  </md-card>
  <div ng-if="false">
    <div angular-html-bind="gadgetPreviewHtml" style="pointer-events: none;"
         class="gadget-panel conversation-skin-left-gadget-panel ng-isolate-scope">
  </div>
</div>

<script type="text/ng-template" id="modals/addGadget">
  <div class="modal-header" style="border-bottom: 0; padding-bottom: 0;">
    <h3 ng-if="!selectedGadgetId">
      Insert a gadget
    </h3>
    <h3 ng-if="selectedGadgetId">
      Customize Gadget (<[GADGET_SPECS[selectedGadgetId].name]>)
    </h3>
  </div>
  <div class="modal-body">
    <div ng-if="!selectedGadgetId" ng-cloak>
      <span class="oppia-gadget-tile" 
            ng-repeat="(key, gadget) in ALLOWED_GADGETS"
            ng-click="onChangeGadgetId(key)">
        <[key]>
      </span>
    </div>
    <div ng-if="selectedGadgetId" class="customization-editor">
      <div class="gadget-name-panel">
        <label>Gadget Name</label>
        <input ng-model="gadgetNameService.displayed" />
      </div>
      <div class="gadget-layout-panel">
        <label class="oppia-gadget-customization-label">Layout</label>
        <select ng-model="gadgetLayoutService.displayed" >
          <option value="left">Left</option>
          <option value="right">Right</option>
          <option value="bottom">Bottom</option>
        </select>
      </div>
      <div class="gadget-state-panel"> 
        <h2 class="oppia-gadget-customization-label">Visible in states</h2>
        <label class="oppia-gadget-customization-label" 
               ng-repeat="state in explorationStates" >
          <input type="checkbox" ng-click="manageVisibilityInStates(state)"
                 ng-checked="gadgetStateVisibilityService.displayed.indexOf(state) > -1"
                 checklist-value="state"> <[state]>
        </label>
      </div>
      <form name="form.schemaForm" class="protractor-test-gadget-editor">
        <div ng-if="customizationArgSpecs.length === 0">
          <em>There are no customization options available.<br><br>
          To use this gadget, click 'Save Gadget'.</em>
        </div>

        <div ng-repeat="customizationArgSpec in customizationArgSpecs">
          <div class="oppia-gadget-customization-label"><[customizationArgSpec.description]></div>
          <div>
            <schema-based-editor local-value="gadgetCustomizationArgsService.displayed[customizationArgSpec.name].value" schema="customizationArgSpec.schema">
            </schema-based-editor>
            <div style="margin-bottom: 15px;"></div>
          </div>
        </div>
      </form>
    </div>    
  </div> 


  <div class="modal-footer">
    <button class="btn btn-default" style="float: left;" 
            ng-click="returnToGadgetSelector()" 
            ng-if="selectedGadgetId">
        Back
    </button>
    <button class="btn btn-default" ng-click="cancel()">Cancel</button>
    <button class="btn btn-success protractor-test-add-gadget" ng-click="addGadget()" ng-disabled="false">Add Gadget</button>
  </div>
</script>